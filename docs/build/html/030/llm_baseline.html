

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>LLM-based Baseline &mdash; RDB2G-Bench 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=2709fde1"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Reinforcement Learning" href="reinforcement_learning.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            RDB2G-Bench
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Get Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../010/install_and_setup.html">Install and Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../010/tutorial.html">Tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Datasets</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../020/download_precomputed.html">Download Pre-computed Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../020/reproduce_datasets.html">Reproduce Datasets</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Benchmarks</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="micro_action.html">Micro Actions</a></li>
<li class="toctree-l1"><a class="reference internal" href="run_benchmark.html">Run Benchmark</a></li>
<li class="toctree-l1"><a class="reference internal" href="random_search.html">Random Search</a></li>
<li class="toctree-l1"><a class="reference internal" href="greedy_search.html">Greedy Search</a></li>
<li class="toctree-l1"><a class="reference internal" href="evolutionary_algorithm.html">Evolutionary Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="bayesian_optimization.html">Bayesian Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="reinforcement_learning.html">Reinforcement Learning</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">LLM-based Baseline</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#how-it-works">How it Works</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id1">LLM-Based baseline</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#rdb2g_bench.benchmark.llm.llm_runner.run_llm_baseline"><code class="docutils literal notranslate"><span class="pre">run_llm_baseline()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-usage">Example Usage</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">RDB2G-Bench</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">LLM-based Baseline</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/030/llm_baseline.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="llm-based-baseline">
<h1>LLM-based Baseline<a class="headerlink" href="#llm-based-baseline" title="Link to this heading"></a></h1>
<p>This module implements Large Language Model (LLM) based baseline.</p>
<section id="how-it-works">
<h2>How it Works<a class="headerlink" href="#how-it-works" title="Link to this heading"></a></h2>
<p>The LLM-based optimization process:</p>
<ol class="arabic simple">
<li><p>Provide the LLM with problem description and search space</p></li>
<li><p>LLM suggests promising micro actions for graph constructions</p></li>
<li><p>Evaluate suggested micro actions on the actual task</p></li>
<li><p>Provide feedback to the LLM about performance</p></li>
<li><p>LLM refines its suggestions based on feedback</p></li>
<li><p>Repeat until the budget is exhausted</p></li>
</ol>
</section>
<section id="id1">
<h2>LLM-Based baseline<a class="headerlink" href="#id1" title="Link to this heading"></a></h2>
<p id="module-rdb2g_bench.benchmark.llm.llm_runner">RDB2G-Bench LLM Baseline Module</p>
<p>This module implements Large Language Model (LLM) based baseline for neural architecture search 
on RDB2G-Bench. The LLM baseline leverages the reasoning capabilities of large language models
to iteratively improve graph modelings.</p>
<p>The LLM approach uses conversational AI to understand the graph modeling task and make informed
decisions about which micro actions to apply for architecture optimization.</p>
<dl class="py function">
<dt class="sig sig-object py" id="rdb2g_bench.benchmark.llm.llm_runner.run_llm_baseline">
<span class="sig-prename descclassname"><span class="pre">rdb2g_bench.benchmark.llm.llm_runner.</span></span><span class="sig-name descname"><span class="pre">run_llm_baseline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'rel-f1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'driver-top3'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">budget_percentage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'claude-3-5-sonnet-latest'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'final'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'/root/.cache/relbench_examples'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">result_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'./results'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><span class="pre">Dict</span></a></span></span><a class="headerlink" href="#rdb2g_bench.benchmark.llm.llm_runner.run_llm_baseline" title="Link to this definition"></a></dt>
<dd><p>Perform Neural Architecture Search using Large Language Model Strategy.</p>
<p>This function implements LLM-based neural architecture search that leverages the reasoning
capabilities of large language models to iteratively improve graph configurations.
The LLM interacts with the search space through natural language, making informed decisions
about micro actions based on current performance and historical context.</p>
<p>The LLM baseline operates in two phases:
1. Initial exploration: Try to find an initial improvement from the full graph configuration
2. Iterative refinement: Continue optimizing based on performance feedback and action history</p>
<dl>
<dt>Args:</dt><dd><dl class="simple">
<dt>dataset (str): Name of the RelBench dataset (e.g., “rel-f1”, “rel-avito”).</dt><dd><p>Defaults to “rel-f1”.</p>
</dd>
<dt>task (str): Name of the RelBench task (e.g., “driver-top3”, “user-ad-visit”).</dt><dd><p>Defaults to “driver-top3”.</p>
</dd>
<dt>budget_percentage (float): Budget percentage for the search process as fraction</dt><dd><p>of total search space. Defaults to 0.05.</p>
</dd>
</dl>
<p>seed (int): Random seed for reproducibility. Defaults to 42.
model (str): LLM model identifier to use for reasoning.</p>
<blockquote>
<div><p>Defaults to “claude-3-5-sonnet-latest”.</p>
</div></blockquote>
<dl class="simple">
<dt>temperature (float): Temperature for LLM generation controlling randomness (0.0-1.0).</dt><dd><p>Higher values increase creativity. Defaults to 0.8.</p>
</dd>
<dt>tag (str): Tag identifying the experiment for result organization.</dt><dd><p>Defaults to “final”.</p>
</dd>
<dt>cache_dir (str): Directory for caching dataset and model data.</dt><dd><p>Defaults to “~/.cache/relbench_examples”.</p>
</dd>
<dt>result_dir (str): Root directory for saving results.</dt><dd><p>Defaults to “./results”.</p>
</dd>
</dl>
<p><a href="#id2"><span class="problematic" id="id3">**</span></a>kwargs: Additional configuration parameters passed to underlying components.</p>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>Dict: Comprehensive results dictionary containing:</dt><dd><ul class="simple">
<li><p>best_score: Best achieved performance score during search</p></li>
<li><p>best_edge_set: Best graph edge configuration found</p></li>
<li><p>best_valid_action_result: Sequence of valid actions leading to best result</p></li>
<li><p>initial_score: Initial performance before search optimization</p></li>
<li><p>initial_edge_set: Initial graph edge configuration</p></li>
<li><p>budget_percentage: Budget percentage used for the search</p></li>
<li><p>initial_budget: Total evaluation budget allocated</p></li>
<li><p>remaining_budget: Unused evaluation budget remaining</p></li>
<li><p>history_actions: String representation of action history</p></li>
<li><p>action_result: Complete sequence of all actions attempted</p></li>
<li><p>score_result: Performance trajectory during search process</p></li>
</ul>
</dd>
</dl>
</dd>
<dt>Raises:</dt><dd><p>ValueError: If ANTHROPIC_API_KEY environment variable is not set
ValueError: If unsupported task type is encountered
ValueError: If link prediction task missing required table attributes</p>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Set API key first</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;ANTHROPIC_API_KEY&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;your_api_key_here&quot;</span>
<span class="gp">&gt;&gt;&gt; </span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Run LLM baseline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">run_llm_baseline</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">dataset</span><span class="o">=</span><span class="s2">&quot;rel-f1&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">task</span><span class="o">=</span><span class="s2">&quot;driver-top3&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">budget_percentage</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">model</span><span class="o">=</span><span class="s2">&quot;claude-3-5-sonnet-latest&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">temperature</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">seed</span><span class="o">=</span><span class="mi">42</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Best performance: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;best_score&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Initial performance: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;initial_score&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Improvement: </span><span class="si">{</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;best_score&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;initial_score&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Note:</dt><dd><p>This function requires an active internet connection and valid Anthropic API credentials.
The ANTHROPIC_API_KEY environment variable must be set before calling this function.
Results are automatically saved to JSON files in the specified output directory.</p>
</dd>
</dl>
</dd></dl>

<section id="example-usage">
<h3>Example Usage<a class="headerlink" href="#example-usage" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">rdb2g_bench.benchmark.runner</span><span class="w"> </span><span class="kn">import</span> <span class="n">run_benchmark</span>

<span class="c1"># Run LLM-based baseline</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">run_benchmark</span><span class="p">(</span>
    <span class="n">dataset</span><span class="o">=</span><span class="s2">&quot;rel-f1&quot;</span><span class="p">,</span>
    <span class="n">task</span><span class="o">=</span><span class="s2">&quot;driver-top3&quot;</span><span class="p">,</span>
    <span class="n">budget_percentage</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
    <span class="n">method</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;llm&quot;</span><span class="p">],</span>
    <span class="n">num_runs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">seed</span><span class="o">=</span><span class="mi">42</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="reinforcement_learning.html" class="btn btn-neutral float-left" title="Reinforcement Learning" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright KAIST Data Mining Lab.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>